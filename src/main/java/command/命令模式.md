# 应用场景

用来控制命令的执行，比如，异步、延迟、排队执行命令、撤销重做命令、存储命令、给命令记录日志等等

# 原理解读

> The command pattern encapsulates a request as an object, thereby letting us parameterize other objects with different requests, queue or log requests, and support undoable operations.

命令模式将请求（命令）封装为一个对象，这样可以使用不同的请求参数化其他对象（将不同请求依赖注入到其他对象），并且能够支持请求（命令）的排队执行、记录日志、撤销等（附加控制）功能。

落实到编码实现，命令模式用的最核心的实现手段，是将函数封装成对象。我们知道，C 语言支持函数指针，我们可以把函数当作变量传递来传递去。但是，在大部分编程语言中，函数没法儿作为参数传递给其他函数，也没法儿赋值给变量。借助命令模式，我们可以将函数封装成对象。具体来说就是，设计一个包含这个函数的类，实例化一个对象传来传去，这样就可以实现把函数像对象一样使用。

从实现的角度来说，它类似回调。当我们把函数封装成对象之后，对象就可以存储下来，方便控制执行。

# 代码实现

- 命令模式将发出请求的对象和执行请求的对象解耦
- 在被解耦的两者之间是通过命令对象进行沟通的。命令对象封装了接收者的一个或多个命令。
- 调用者通过调用命令对象的 execute() 方法来发出请求，这会使接受者的动作被调用。
- 调用者可以通过命令进行参数化，甚至可以在运行时动态地进行参数化。
- 命令可以支持撤消 undo()，将对象恢复到上次调用 execute() 方法之前的状态。
- 宏命令是命令的简单扩展，它允许调用多个命令。同样，宏命令可以轻松支持撤销 undo()。

## 相关demo目录：

```java
├───src
│   ├───main
│   │   ├───java
│   │   │   └───command				// 命令模式相关demo
│   │   │       ├───remotecontrol	// 家具遥控器

```

## 家具遥控器

创建一组控制遥控器的API，让每个按钮都能控制一个装置。能控制目前和任何未来可能出现的装置。

请求者可以说遥控器，而执行者对象就是家居厂商类其中之一的实例。

利用命令对象，把请求动作（打开电灯）封装成一个特定对象（客厅电灯对象）。每个按钮存储一个命令对象，当按钮按下，可以请命令对象做相关工作。遥控器并不需要知道工作内容，只要有个命令对象能和正确的对象沟通，把事情做好就行了。

```git
迭代版本
1739357d8d 简易遥控器
6d9ba46a79 遥控器
bd78f8a0e6 新增撤销功能
b73d4262f3 吊扇新增速度状态，不局限于改变开关状态
1b9c7284a1 宏命令，实现一个按键执行多个命令
129a6a37bd 利用lambda表达式替换具体的Command对象
```

